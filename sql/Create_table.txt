-- Generated by Oracle SQL Developer Data Modeler 23.1.0.087.0806
--   at:        2024-05-01 16:17:12 KST
--   site:      Oracle Database 21c
--   type:      Oracle Database 21c



DROP TABLE menu CASCADE CONSTRAINTS;

DROP TABLE order_detail CASCADE CONSTRAINTS;

DROP TABLE review CASCADE CONSTRAINTS;

DROP TABLE user_info CASCADE CONSTRAINTS;

DROP TABLE user_order CASCADE CONSTRAINTS;

-- predefined type, no DDL - MDSYS.SDO_GEOMETRY

-- predefined type, no DDL - XMLTYPE

CREATE TABLE menu (
    menu_id NUMBER GENERATED BY DEFAULT AS IDENTITY (
        START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE
    ) NOT NULL,
    name VARCHAR2(30) NOT NULL,
    price INTEGER NOT NULL,
    category VARCHAR(20) NOT NULL,
    menu_desc VARCHAR2(100) NOT NULL,
    menu_path VARCHAR(500) NOT NULL
)
LOGGING;

ALTER TABLE menu ADD CONSTRAINT menu_pk PRIMARY KEY (menu_id);


CREATE TABLE order_detail (
    detail_id NUMBER GENERATED BY DEFAULT AS IDENTITY (
        START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE
    ) NOT NULL,
    menu_menu_id INTEGER NOT NULL,
    user_order_order_id INTEGER NOT NULL,
    quantity INTEGER NOT NULL
)
LOGGING;

ALTER TABLE order_detail ADD CONSTRAINT order_detail_pk PRIMARY KEY (detail_id);


CREATE TABLE review (
    review_id NUMBER GENERATED BY DEFAULT AS IDENTITY (
        START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE
    ) NOT NULL,
    title VARCHAR2(50) NOT NULL,
    content VARCHAR2(500) NOT NULL,
    rating INTEGER NOT NULL,
    review_date DATE NOT NULL,
    menu_menu_id INTEGER NOT NULL,
    order_detail_detail_id INTEGER NOT NULL
)
LOGGING;

ALTER TABLE review ADD CONSTRAINT review_pk PRIMARY KEY (review_id);


CREATE TABLE user_info (
    user_id NUMBER GENERATED BY DEFAULT AS IDENTITY (
        START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE
    ) NOT NULL,
    phonenum INTEGER NOT NULL,
    join_date DATE NOT NULL,
    point INTEGER NOT NULL,
    status INTEGER DEFAULT 1 NOT NULL
)
LOGGING;

ALTER TABLE user_info ADD CONSTRAINT user_info_pk PRIMARY KEY (user_id);
ALTER TABLE user_info ADD CONSTRAINT user_info_pkv1 UNIQUE (phonenum);


CREATE TABLE user_order (
    order_id NUMBER GENERATED BY DEFAULT AS IDENTITY (
        START WITH 1 INCREMENT BY 1 NOCACHE NOCYCLE
    ) NOT NULL,
    order_date DATE NOT NULL,
    menu_menu_id INTEGER NOT NULL,
    user_id INTEGER NOT NULL
)
LOGGING;

ALTER TABLE user_order ADD CONSTRAINT order_pk PRIMARY KEY (order_id);



ALTER TABLE order_detail
    ADD CONSTRAINT order_detail_menu_fk FOREIGN KEY ( menu_menu_id )
        REFERENCES menu ( menu_id )
    NOT DEFERRABLE;

ALTER TABLE order_detail
    ADD CONSTRAINT order_detail_user_order_fk FOREIGN KEY ( user_order_order_id )
        REFERENCES user_order ( order_id )
    NOT DEFERRABLE;

ALTER TABLE user_order
    ADD CONSTRAINT order_user_info_fk FOREIGN KEY ( user_id )
        REFERENCES user_info ( user_id )
    NOT DEFERRABLE;

ALTER TABLE review
    ADD CONSTRAINT review_menu_fk FOREIGN KEY ( menu_menu_id )
        REFERENCES menu ( menu_id )
    NOT DEFERRABLE;

ALTER TABLE review
    ADD CONSTRAINT review_order_detail_fk FOREIGN KEY ( order_detail_detail_id )
        REFERENCES order_detail ( detail_id )
    NOT DEFERRABLE;



-- Oracle SQL Developer Data Modeler Summary Report: 
-- 
-- CREATE TABLE                             5
-- CREATE INDEX                             0
-- ALTER TABLE                             11
-- CREATE VIEW                              0
-- ALTER VIEW                               0
-- CREATE PACKAGE                           0
-- CREATE PACKAGE BODY                      0
-- CREATE PROCEDURE                         0
-- CREATE FUNCTION                          0
-- CREATE TRIGGER                           0
-- ALTER TRIGGER                            0
-- CREATE COLLECTION TYPE                   0
-- CREATE STRUCTURED TYPE                   0
-- CREATE STRUCTURED TYPE BODY              0
-- CREATE CLUSTER                           0
-- CREATE CONTEXT                           0
-- CREATE DATABASE                          0
-- CREATE DIMENSION                         0
-- CREATE DIRECTORY                         0
-- CREATE DISK GROUP                        0
-- CREATE ROLE                              0
-- CREATE ROLLBACK SEGMENT                  0
-- CREATE SEQUENCE                          0
-- CREATE MATERIALIZED VIEW                 0
-- CREATE MATERIALIZED VIEW LOG             0
-- CREATE SYNONYM                           0
-- CREATE TABLESPACE                        0
-- CREATE USER                              0
-- 
-- DROP TABLESPACE                          0
-- DROP DATABASE                            0
-- 
-- REDACTION POLICY                         0
-- 
-- ORDS DROP SCHEMA                         0
-- ORDS ENABLE SCHEMA                       0
-- ORDS ENABLE OBJECT                       0
-- 
-- ERRORS                                   0
-- WARNINGS                                 0
